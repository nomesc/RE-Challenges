This one had some anti debugging and anti patching.  
The serial was calculated using a isDebugged variable too which is 1 if debugged 0 otheriwse.  
The MAGIC function calls a executableChecking function that checks the first 0x155 bytes of TrueDialog function.  
keygen and i64 database included.
